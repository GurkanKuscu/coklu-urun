<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hunca Set ÃœrÃ¼n Hesaplama</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#ea580c',
                        accent: '#16a34a',
                    }
                }
            }
        }
    </script>
    </script>
    <style>
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
        
        /* Geri butonu stilleri */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            background: #1e40af;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            z-index: 1000;
        }
        
        .back-button:hover {
            background: #1e3a8a;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        
        /* Ã–zel kart stilleri */
        .card {
            transition: all 0.3s ease;
            border-radius: 16px;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Ã–zel gradient arka plan */
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        /* Progress bar animasyonu */
        .progress-bar {
            height: 6px;
            border-radius: 3px;
            background: #e5e7eb;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-8 px-4">
    <!-- Geri DÃ¶n Butonu -->
    <button class="back-button" onclick="goBack()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        Geri DÃ¶n
    </button

    </div>

    <!-- Set Ä°smi Modal -->
    <div id="setNameModal" class="fixed inset-0 w-full h-full bg-black bg-opacity-50 z-50 flex items-center justify-center hidden modal">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4">
            <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">Set Ä°smi Ne Olsun?</h3>
            <input type="text" id="setNameInput" class="w-full p-4 border-2 border-gray-300 rounded-xl mb-6 focus:border-blue-500 focus:ring-2 focus:ring-blue-200" placeholder="Set ismini girin">
            <div class="flex justify-center space-x-4">
                <button id="cancelSetBtn" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-xl hover:bg-gray-400 transition">Ä°ptal</button>
                <button id="confirmSetBtn" class="px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition">Tamamla</button>
            </div>
        </div>
    </div>

   <div class="max-w-7xl mx-auto">
        <!-- BaÅŸlÄ±k BÃ¶lÃ¼mÃ¼ -->
        <div class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 mb-4"> Set ÃœrÃ¼n KarlÄ±lÄ±k Hesaplama Sistemi | OCAK 2026 </h1>
            <p class="text-gray-600 max-w-2xl mx-auto"> 2026 Verileri Dikkate AlÄ±narak HesaplanmaktadÄ±r! | By Gurkan KUSCU
        </div>

        </h1>
        
        <div class="space-y-8">
            <!-- ÃœrÃ¼n SeÃ§im BÃ¶lÃ¼mÃ¼ -->
            <div class="bg-white rounded-2xl shadow-xl p-8 border border-blue-100">
                <h2 class="text-2xl font-bold mb-6 text-blue-800 flex items-center">
                    ğŸ›’ï¸ ÃœrÃ¼n SeÃ§imi
                </h2>
                <div class="space-y-6">
                    <!-- Marka ve Kategori yan yana -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Marka SeÃ§in</label>
                            <select 
                                id="brandSelect"
                                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-gray-50 hover:bg-white"
                            >
                                <option value="">Marka SeÃ§iniz</option>
                                <!-- Markalar JavaScript ile doldurulacak -->
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Kategori SeÃ§in</label>
                            <select 
                                id="categorySelect"
                                disabled
                                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed transition-all duration-200 bg-gray-50 hover:bg-white"
                            >
                                <option value="">Kategori SeÃ§iniz</option>
                                <!-- Kategoriler JavaScript ile doldurulacak -->
                            </select>
                        </div>
                    </div>

                    <!-- ÃœrÃ¼n seÃ§imi - Marka ve Kategorinin altÄ±nda -->
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-3">ÃœrÃ¼n SeÃ§in</label>
                        <select 
                            id="productSelect"
                            disabled
                            class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed transition-all duration-200 bg-gray-50 hover:bg-white"
                        >
                            <option value="">ÃœrÃ¼n SeÃ§iniz</option>
                            <!-- ÃœrÃ¼nler JavaScript ile doldurulacak -->
                        </select>
                    </div>
                    
                    <!-- Adet ve Ekle butonu -->
                    <div class="grid grid-cols-3 gap-4">
                        <div class="col-span-1">
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Adet</label>
                            <input 
                                type="number" 
                                id="addQuantity"
                                value="1"
                                min="1"
                                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
                            />
                        </div>
                        <div class="col-span-2 flex items-end">
                            <button 
                                id="addProductButton"
                                disabled
                                class="w-full p-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl transition-all duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed"
                            >
                                â• Listeye Ekle
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Set Ä°Ã§eriÄŸi BÃ¶lÃ¼mÃ¼ -->
            <div id="productSetSection" class="bg-white rounded-2xl shadow-xl p-8 border border-purple-100 hidden">
                <h2 class="text-2xl font-bold mb-6 text-purple-800 flex items-center">
                    ğŸ“¦ Set Ä°Ã§eriÄŸi
                </h2>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="p-4 text-left">ÃœrÃ¼n AdÄ±</th>
                                <th class="p-4 text-center">Marka</th>
                                <th class="p-4 text-center">Kategori</th>
                                <th class="p-4 text-center">Birim Fiyat</th>
                                <th class="p-4 text-center">Adet</th>
                                <th class="p-4 text-center">Toplam</th>
                                <th class="p-4 text-center">Ä°ÅŸlem</th>
                            </tr>
                        </thead>
                        <tbody id="productSetList">
                            <!-- Set iÃ§indeki Ã¼rÃ¼nler buraya eklenecek -->
                        </tbody>
                        <tfoot class="bg-gray-50 font-bold">
                            <tr>
                                <td colspan="5" class="p-4 text-right">Toplam AlÄ±ÅŸ Maliyeti (KDV HariÃ§):</td>
                                <td class="p-4 text-center" id="setTotalWithoutVAT">â‚º0.00</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td colspan="5" class="p-4 text-right">Toplam AlÄ±ÅŸ Maliyeti (KDV Dahil):</td>
                                <td class="p-4 text-center" id="setTotalWithVAT">â‚º0.00</td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                <div class="mt-6 flex justify-end space-x-4">
                    <button id="clearSetButton" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200">
                        ğŸ—‘ï¸ Seti Temizle
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Sol Panel - ÃœrÃ¼n ve AlÄ±ÅŸ Bilgileri -->
                <div class="bg-white rounded-2xl shadow-xl p-8 border border-orange-100">
                    <h2 class="text-2xl font-bold mb-6 text-orange-800 flex items-center">
                        ğŸ“¦ AlÄ±ÅŸ Bilgileri
                    </h2>
                    <div class="space-y-6">
                        <div class="grid grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-70 mb-3">Toplam AlÄ±ÅŸ FiyatÄ± (KDV HariÃ§)</label>
                                <input 
                                    type="number" 
                                    id="purchasePrice"
                                    readonly
                                    class="w-full p-4 border-2 border-gray-200 rounded-xl bg-gray-50 text-gray-700 font-bold text-lg"
                                    value="0"
                                />
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Toplam Adet</label>
                                <input 
                                    type="number" 
                                    id="totalQuantity"
                                    readonly
                                    value="0"
                                    class="w-full p-4 border-2 border-gray-200 rounded-xl bg-gray-50 text-gray-700 font-bold text-lg"
                                />
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Toplam AlÄ±ÅŸ FiyatÄ± (KDV Dahil)</label>
                            <input 
                                type="number" 
                                id="totalWithVAT"
                                readonly
                                class="w-full p-4 border-2 border-blue-200 rounded-xl bg-blue-50 text-blue-800 font-bold text-xl"
                                value="0"
                            />
                        </div>

                        <div class="grid grid-cols-2 gap-6">
                            <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-xl border-2 border-orange-200">
                                <label class="block text-sm font-bold text-orange-700 mb-3">ğŸ­ Hunca Hak EdiÅŸ</label>
                                <div class="text-xl font-bold text-orange-800 mb-2" id="totalHuncaProfit">â‚º0.00</div>
                                <div class="text-xs text-gray-600 mb-3"><span id="huncaProfit">â‚º0.00</span> Ã— <span id="quantityDisplay">0</span> adet</div>
                                <div class="border-t border-orange-200 pt-3">
                                    <div class="text-orange-700 font-semibold">KDV Dahil: <span id="totalHuncaProfitWithVAT">â‚º0.00</span></div>
                                    <div class="text-xs text-gray-500"><span id="huncaProfitWithVAT">â‚º0.00</span> Ã— <span id="quantityDisplay2">0</span> adet</div>
                                </div>
                            </div>
                            <div class="bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-xl border-2 border-red-200">
                                <label class="block text-sm font-bold text-red-700 mb-3">ğŸ”´ KÄ±rmÄ±zÄ± Beyaz Hak EdiÅŸ</label>
                                <div class="text-xl font-bold text-red-800 mb-2" id="totalRedWhiteProfit">â‚º0.00</div>
                                <div class="text-xs text-gray-600 mb-3"><span id="redWhiteProfit">â‚º0.00</span> Ã— <span id="quantityDisplay3">0</span> adet</div>
                                <div class="border-t border-red-200 pt-3">
                                    <div class="text-red-700 font-semibold">KDV Dahil: <span id="totalRedWhiteProfitWithVAT">â‚º0.00</span></div>
                                    <div class="text-xs text-gray-500"><span id="redWhiteProfitWithVAT">â‚º0.00</span> Ã— <span id="quantityDisplay4">0</span> adet</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SaÄŸ Panel - SatÄ±ÅŸ ve Komisyon Bilgileri -->
                <div class="bg-white rounded-2xl shadow-xl p-8 border border-green-100">
                    <h2 class="text-2xl font-bold mb-6 text-green-800 flex items-center">
                        ğŸ’° SatÄ±ÅŸ ve Komisyon Bilgileri
                    </h2>
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-3">Set SatÄ±ÅŸ FiyatÄ± (KDV Dahil)</label>
                            <input 
                                type="number" 
                                id="salesPrice"
                                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-500 focus:border-green-500 transition-all duration-200"
                                placeholder="Manuel giriÅŸ"
                            />
                        </div>

                        <div class="grid grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Komisyon OranÄ± (%)</label>
                                <input 
                                    type="number" 
                                    id="commissionRate"
                                    class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-green-500 focus:border-green-500 transition-all duration-200"
                                    placeholder="Manuel giriÅŸ"
                                    step="0.1"
                                />
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Kargo TÃ¼rÃ¼</label>
                                <select 
                                    id="cargoType"
                                    class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
                                >
                                    <option value="PTT-TEX">PTT-TEX</option>
                                    <option value="Ã–zel Kargo">Ã–zel Kargo FiyatÄ±</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-3">Reklam OranÄ± (%)</label>
                                <input 
                                    type="number" 
                                    id="advertisementRate"
                                    class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-4 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200"
                                    placeholder="Manuel giriÅŸ"
                                    step="0.1"
                                />
                            </div>
                        </div>

                        <div class="grid grid-cols-3 gap-4">
                            <div class="bg-gradient-to-br from-green-50 to-green-100 p-5 rounded-xl border-2 border-green-200">
                                <label class="block text-sm font-bold text-green-700 mb-2">ğŸ’³ Komisyon TutarÄ±</label>
                                <div class="text-lg font-bold text-green-800" id="commissionAmount">â‚º0.00</div>
                                <div class="text-xs text-gray-500 mt-1">KDV Dahil</div>
                            </div>
                            <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-5 rounded-xl border-2 border-blue-200">
                                <label class="block text-sm font-bold text-blue-700 mb-2">
                                    ğŸšš Kargo TutarÄ±- <span id="cargoTypeLabel">PTT-TEX</span>
                                </label>
                                <div id="standardCargo">
                                    <div class="text-lg font-bold text-blue-800" id="cargoPrice">â‚º0.00</div>
                                    <div class="text-xs text-gray-500 mt-1">
                                        KDV Dahil
                                    </div>
                                </div>
                                <div id="customCargo" class="hidden">
                                    <input 
                                        type="number" 
                                        id="customCargoPrice"
                                        class="w-full p-3 border-2 border-gray-200 rounded-lg focus:ring-4 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
                                        placeholder="Kargo Ã¼creti girin"
                                    />
                                </div>
                            </div>
                            <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-5 rounded-xl border-2 border-purple-200">
                                <label class="block text-sm font-bold text-purple-700 mb-2">ğŸ“¢ Reklam TutarÄ±</label>
                                <div class="text-lg font-bold text-purple-800" id="advertisementAmount">â‚º0.00</div>
                                <div class="text-xs text-gray-50 mt-1">KDV Dahil</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Kar MarjÄ± ve TutarlarÄ± -->
            <div class="bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
                <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                    ğŸ“Š Kar MarjÄ± ve TutarlarÄ±
                </h2>
                <div class="grid grid-cols-3 gap-8">
                    <div class="bg-gradient-to-br from-emerald-50 to-emerald-100 p-8 rounded-2xl border-2 border-emerald-200 shadow-lg hover:shadow-xl transition-all duration-300">
                        <div class="text-center">
                            <div class="text-6xl mb-4">ğŸ“ˆ</div>
                            <h3 class="font-bold text-xl mb-4 text-emerald-800">Net Kar<br />OranÄ±</h3>
                            <div class="text-4xl font-bold text-emerald-700 mb-2" id="netProfitRate">
                                0.00%
                            </div>
                            <div class="text-sm text-gray-600 bg-white rounded-lg p-2" id="netProfitRateDescription">
                                Net Kar / Toplam AlÄ±ÅŸ Maliyeti (KDV Dahil)
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-sky-50 to-sky-100 p-8 rounded-2xl border-2 border-sky-200 shadow-lg hover:shadow-xl transition-all duration-300">
                        <div class="text-center">
                            <div class="text-6xl mb-4">ğŸ’µ</div>
                            <h3 class="font-bold text-xl mb-4 text-sky-800">Net Kar<br />TutarÄ±</h3>
                            <div class="text-4xl font-bold text-sky-700 mb-2" id="netProfit">
                                â‚º0.00
                            </div>
                            <div class="text-sm text-gray-600 bg-white rounded-lg p-2">SatÄ±ÅŸ - Komisyon - Kargo - Reklam - AlÄ±ÅŸ FiyatÄ± (KDV Dahil)</div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-violet-50 to-violet-100 p-8 rounded-2xl border-2 border-violet-200 shadow-lg hover:shadow-xl transition-all duration-300">
                        <div class="text-center">
                            <div class="text-6xl mb-4">ğŸ¯</div>
                            <h3 class="font-bold text-xl mb-4 text-violet-800">KB Hak EdiÅŸ DÃ¼ÅŸÃ¼lmÃ¼ÅŸ</h3>
                            <div class="text-4xl font-bold text-violet-700 mb-2" id="finalProfit">
                                â‚º0.00
                            </div>
                            <div class="text-sm text-gray-600 bg-white rounded-lg p-2">Net Kar - KÄ±rmÄ±zÄ± Beyaz Hak EdiÅŸ (KDV Dahil)</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Yeni Eklenen Kar PaylaÅŸÄ±mÄ± BÃ¶lÃ¼mÃ¼ -->
            <div class="bg-white rounded-2xl shadow-xl p-8 border border-gray-100">
                <h2 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                    ğŸ¤ Kar PaylaÅŸÄ±mÄ±
                </h2>
                <div class="grid grid-cols-3 gap-8">
                    <div class="bg-gradient-to-br from-amber-50 to-amber-100 p-8 rounded-2xl border-2 border-amber-200 shadow-lg hover:shadow-xl transition-all duration-300">
                        <div class="text-center">
                            <div class="text-6xl mb-4">ğŸ“Š</div>
                            <h3 class="font-bold text-xl mb-4 text-amber-800">PaylaÅŸÄ±lacak Kar<br />(%)</h3>
                            <div class="text-4xl font-bold text-amber-700 mb-2" id="sharedProfitRate">
                                0.00%
                            </div>
                            <div class="text-sm text-gray-600 bg-white rounded-lg p-2">PaylaÅŸÄ±lacak Kar / Toplam AlÄ±ÅŸ Maliyeti (KDV Dahil)</div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-cyan-50 to-cyan-100 p-8 rounded-2xl border-2 border-cyan-200 shadow-lg hover:shadow-xl transition-all duration-300">
                        <div class="text-center">
                            <div class="text-6xl mb-4">ğŸ’°</div>
                            <h3 class="font-bold text-xl mb-4 text-cyan-800">PaylaÅŸÄ±lacak Kar<br />(TL)</h3>
                            <div class="text-4xl font-bold text-cyan-700 mb-2" id="sharedProfit">
                                â‚º0.00
                            </div>
                            <div class="text-sm text-gray-600 bg-white rounded-lg p-2">KB Hak EdiÅŸ DÃ¼ÅŸÃ¼lmÃ¼ÅŸ ile aynÄ±</div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-br from-rose-50 to-rose-100 p-8 rounded-2xl border-2 border-rose-200 shadow-lg hover:shadow-xl transition-all duration-300">
                        <div class="text-center">
                            <div class="text-6xl mb-4">ğŸ­</div>
                            <h3 class="font-bold text-xl mb-4 text-rose-800">Hunca Kar<br />Hak EdiÅŸ</h3>
                            <div class="text-4xl font-bold text-rose-700 mb-2" id="huncaProfitShare">
                                â‚º0.00
                            </div>
                            <div class="text-sm text-gray-600 bg-white rounded-lg p-2">PaylaÅŸÄ±lacak KarÄ±n YarÄ±sÄ±</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Set Ä°ÅŸlem ButonlarÄ± -->
            <div class="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
                <div class="flex justify-center space-x-6">
                    <button id="createSetButton" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-xl transition-all duration-200 flex items-center">
                        ğŸ’¾ Seti OluÅŸtur
                    </button>
                    <button id="deleteCurrentSetButton" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-8 rounded-xl transition-all duration-200 flex items-center">
                        ğŸ—‘ï¸ Seti Sil
                    </button>
                </div>
            </div>

            <!-- OluÅŸturulan Setler BÃ¶lÃ¼mÃ¼ -->
            <div id="savedSetsSection" class="bg-white rounded-2xl shadow-xl p-8 border border-gray-100 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                        ğŸ’¾ OluÅŸturulan Setler
                    </h2>
                    <div class="flex space-x-4">
                        <button id="downloadAllSetsBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-xl transition-all duration-200 flex items-center">
                            ğŸ“¥ Toplu Ä°ndir
                        </button>
                        <button id="deleteAllSetsBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-xl transition-all duration-200 flex items-center">
                            ğŸ—‘ï¸ Toplu Sil
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="p-4 text-left">Set AdÄ±</th>
                                <th class="p-4 text-center">ÃœrÃ¼n Adedi</th>
                                <th class="p-4 text-center">ÃœrÃ¼n AdlarÄ±</th>
                                <th class="p-4 text-center">SatÄ±ÅŸ FiyatÄ±</th>
                                <th class="p-4 text-center">Net Kar</th>
                                <th class="p-4 text-center">PaylaÅŸÄ±lacak Kar</th>
                                <th class="p-4 text-center">Ä°ÅŸlem</th>
                            </tr>
                        </thead>
                        <tbody id="savedSetsList">
                            <!-- OluÅŸturulan setler buraya eklenecek -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SÄ±fÄ±rla Butonu -->
            <div class="text-center">
                <button id="resetButton" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-8 rounded-xl transition-all duration-200">
                    TÃ¼mÃ¼nÃ¼ SÄ±fÄ±rla
                </button>
            </div>
        </div>
    </div>

    <script>
        // Sadece 5 Ã¼rÃ¼n ile sÄ±nÄ±rlÄ± veri
        const productDataText = `SAP	ÃœRÃœN ADI	MARKA	KATEGORÄ°	HUNCA+KM SATIÅ FÄ°YATI (TL)
900004274	BLACK MAGIC KUTU KOFRE (M) EDT+DEO R23#	BLACK MAGIC	KOFRE	â‚º189,00
405500191	SHE FUN BODY MIST (W) 200ML#	SHE	BODY MIST	â‚º84,00
405500192	SHE SWEET BODY MIST (W) 200ML#	SHE	BODY MIST	â‚º84,00
405500193	SHE SEXY BODY MIST (W) 200ML#	SHE	BODY MIST	â‚º84,00
405500194	SHE COOL BODY MIST (W) 200ML#	SHE	BODY MIST	â‚º84,00
405500195	SHE LOVE BODY MIST (W) 200ML#	SHE	BODY MIST	â‚º84,00
405500196	SHE PRETTY BODY MIST (W) 200ML#	SHE	BODY MIST	â‚º84,00
405500197	SHE CLUBBER BODY MIST (W) 200ML#	SHE	BODY MIST	â‚º84,00
405500198	SHE ANGEL BODY MIST (W) 200ML#	SHE	BODY MIST	â‚º84,00
410801600	HUNCA INTIMATE CARE JEL 250ML R25#	HUNCA	INTIMATE JEL	â‚º55,45
402700259	H.BIOTEN BEYAZLATICI ROLL-ON 40ML	HUNCA	BEYAZLATICI ROLLON	â‚º42,50
401500227	BLACK MAGIC DEO (M) 150ML R23#	BLACK MAGIC	DEODORANT	â‚º52,00
900003788	CALDION KUTU KOFRE (M) 50EDT+DEO#	CALDION	KOFRE	â‚º168,00
900003789	CALDION KUTU KOFRE (W) 50EDT+DEO#	CALDION	KOFRE	â‚º168,00
900003792	CALDION NIGHT KUTU KOFRE (M) EDT+DEO#	CALDION	KOFRE	â‚º201,00
900003793	CALDION NIGHT KUTU KOFRE (W) EDT+DEO#	CALDION	KOFRE	â‚º201,00
900003944	CALDION KOFRE (W)EDT 100ML+DEO R09 PEN#8	CALDION	KOFRE	â‚º201,00
900003945	CALDION KOFRE (M)EDT 100ML+DEO R09 PEN#	CALDION	KOFRE	â‚º210,00
400000151	CALDION EDT (M) 100ML#	CALDION	EDT	â‚º152,00
400500186	CALDION EDT (W) 100ML#	CALDION	EDT	â‚º152,00
400500338	CALDION EDT (W) 50ML K.KUTU L23#	CALDION	EDT	â‚º107,00
401500100	CALDION DEO (M) 150ML#	CALDION	DEODORANT	â‚º52,00
401500101	CALDION NIGHT DEO (M) 150ML#	CALDION	DEODORANT	â‚º52,00
402000265	CALDION DEO (W) 150ML#	CALDION	DEODORANT	â‚º52,00
402000266	CALDION NIGHT DEO (W) 150ML#	CALDION	DEODORANT	â‚º52,00
402700200	CALDION ROLLON (M) 50ML R23#	CALDION	ROLL-ON	â‚º30,50
402700201	CALDION ROLLON (W) 50ML R23#	CALDION	ROLL-ON	â‚º30,50
900003805	CARMINELLA KUTU KOFRE (W) EDT+DEO#	CARMINELLA	KOFRE	â‚º222,50
900003910	CARMINELLA LOVE KOFRE(W)EDT+DEO#	CARMINELLA	KOFRE	â‚º222,50
400500205	CARMINELLA EDT (W) 100ML#	CARMINELLA	EDT	â‚º171,00
402000275	CARMINELLA DEO (W) 150ML#	CARMINELLA	DEODORANT	â‚º52,00
402000410	CARMINELLA LOVE DEO(W)150ML#	CARMINELLA	DEODORANT	â‚º52,00
900003947	EQUAL KOFRE MEN EDT 75 ML+DEO PEN R11#	EQUAL	KOFRE	â‚º196,50
900003948	EQUAL KOFRE WOMEN EDT 75 ML+DEO PEN R11#	EQUAL	KOFRE	â‚º196,50
401500108	EQUAL DEO (M) 150ML#	EQUAL	DEODORANT	â‚º52,00
402000272	EQUAL DEO (W) 150ML#	EQUAL	DEODORANT	â‚º52,00
402700207	EQUAL ROLLON (M) 50ML R23#	EQUAL	ROLL-ON	â‚º30,50
402700159	EQUAL EDT (M) 75ML#	EQUAL	EDT	â‚º155,50
402700209	EQUAL EDT (W) 75ML#	EQUAL	EDT	â‚º155,50
402700208	EQUAL ROLLON (W) 50ML R23#	EQUAL	ROLL-ON	â‚º30,50
900004190	EXTORY OCRA KOFRE MEN EDT+DEO R22#	EXTORY	KOFRE	â‚º200,00
900004191	EXTORY COBALT KOFRE MEN EDT+DEO R22#	EXTORY	KOFRE	â‚º200,00
410800400	HUNCA CARE DEFNE&SARIMSAK SAMPUAN 675ML#	HUNCA CARE	ÅAMPUAN	â‚º47,00
410800401	HUNCA CARE ZEYTIN&ARGAN SAMPUAN 675ML#	HUNCA CARE	ÅAMPUAN	â‚º47,00
410800402	HUNCA CARE BITTIM&C.OTU SAMPUAN 675ML#	HUNCA CARE	ÅAMPUAN	â‚º47,00
410801403	HUNCA CARE BITK.KOMPLEKS SAMPUAN 675ML R21#	HUNCA CARE	ÅAMPUAN	â‚º47,00
410800773	HUNCA CARE BIBERIYE/YULAF SAMPUAN 675ML#	HUNCA CARE	ÅAMPUAN	â‚º47,00
410801089	HUNCA CARE ISIRGAN OTU SAMPUANI 675ML#	HUNCA CARE	ÅAMPUAN	â‚º47,00
410801372	HUNCA CARE KERATIN SAMPUAN 675ML#	HUNCA CARE	ÅAMPUAN	â‚º47,00
800050000	HUNCA CARE DEFNE&SARIMSAK SAMPUAN 485ML#	HUNCA CARE	ÅAMPUAN	â‚º42,25
800050001	HUNCA CARE ZEYTIN&ARGAN SAMPUAN 485ML#	HUNCA CARE	ÅAMPUAN	â‚º42,25
800050002	HUNCA CARE BITTIM&C.OTU SAMPUAN 485ML#	HUNCA CARE	ÅAMPUAN	â‚º42,25
800050013	HUNCA CARE BITK.KOMPLEKS SAMPUAN 485 R21#	HUNCA CARE	ÅAMPUAN	â‚º42,25
800050003	HUNCA CARE BIBERIYE/YULAF SAMPUAN 485ML#	HUNCA CARE	ÅAMPUAN	â‚º42,25
800050004	HUNCA CARE ISIRGAN OTU SAMPUANI 485ML#	HUNCA CARE	ÅAMPUAN	â‚º42,25
800050005	HUNCA CARE KERATIN SAMPUAN 485ML#	HUNCA CARE	ÅAMPUAN	â‚º42,25
410800404	HUNCA CARE ZEYTIN&ARGAN SAC KREMI 400ML#	HUNCA CARE	SAÃ‡ KREMÄ°	â‚º42,00
410800405	HUNCA CARE DEFNE&SARIM. SAC KREMI 400ML#	HUNCA CARE	SAÃ‡ KREMÄ°	â‚º42,00
410800407	HUNCA CARE AT KESTANESI 500ML#	HUNCA CARE	MASAJ KREMÄ°	â‚º88,00
900004180	IVRINDI KUTU KOFRE (W) EDT+DEO R22#	IVRINDI	KOFRE	â‚º197,00
400500333	IVRINDI EDT (W) 55ML R22#	IVRINDI	EDT	â‚º144,50
402000269	IVRINDI DEO (W) 150ML#	IVRINDI	DEODORANT	â‚º52,00
900004285	JAGLER CLASSIC KOFRE (W) EDT+DEO L24#	JAGLER	KOFRE	â‚º222,00
900003826	JAGLER KOFRE (M) EDT(50ML)+DEO(100ML)#	JAGLER	KOFRE	â‚º175,50
900004253	JAGLER HERO KUTU KOFRE (M) 90EDT+DEO#	JAGLER	KOFRE	â‚º240,00
900004255	JAGLER ENERGY KUTU KOFRE (M) 90EDT+DEO#	JAGLER	KOFRE	â‚º240,00
900004256	JAGLER EXTREME KOFRE (M) 90EDT+DEO#	JAGLER	KOFRE	â‚º240,00
900004257	JAGLER GOLD KUTU KOFRE (W) EDT+DEO#	JAGLER	KOFRE	â‚º222,00
900004258	JAGLER PEARL KUTU KOFRE (W) EDT+DEO#	JAGLER	KOFRE	â‚º222,00
900004264	JAGLER CLAS. KOFRE (M) EDT90+DEO150 R23#	JAGLER	KOFRE	â‚º240,00
900004265	JAGLER SPORT KOFRE (M) EDT90+DEO150 R23#	JAGLER	KOFRE	â‚º240,00
900004266	JAGLER STORM KOFRE (M) EDT90+DEO150 R23#	JAGLER	KOFRE	â‚º240,00
900004267	JAGLER BLACK KOFRE (M) EDT90+DEO150 R23#	JAGLER	KOFRE	â‚º240,00
400000238	JAGLER SPORT EDT (M) 90ML R24#	JAGLER	EDT	â‚º174,00
400000156	JAGLER STORM EDT (M) 90ML#	JAGLER	EDT	â‚º174,00
400000157	JAGLER BLACK EDT (M) 90ML#	JAGLER	EDT	â‚º174,00
400000237	JAGLER KLASIK EDT (M) 90ML R24#	JAGLER	EDT	â‚º174,00
400500367	JAGLER CLASSIC EDT (W) 60ML R24#	JAGLER	EDT	â‚º166,00
400000180	JAGLER EDT (M) 50ML K.KUTU L23#	JAGLER	EDT	â‚º126,00
400000234	JAGLER HERO EDT (M) 90ML#	JAGLER	EDT	â‚º174,00
400000235	JAGLER ENERGY EDT (M) 90ML#	JAGLER	EDT	â‚º174,00
400000236	JAGLER EXTREME EDT (M) 90ML#	JAGLER	EDT	â‚º174,00
400500361	JAGLER PEARL EDT (W) 60ML#	JAGLER	EDT	â‚º166,00
400500362	JAGLER GOLD EDT (W) 60ML#	JAGLER	EDT	â‚º166,00
401500216	JAGLER HERO DEO (M) 150ML#	JAGLER	DEODORANT	â‚º52,00
401500217	JAGLER ENERGY DEO (M) 150ML#	JAGLER	DEODORANT	â‚º52,00
401500218	JAGLER EXTREME DEO (M) 150ML#	JAGLER	DEODORANT	â‚º52,00
402000613	JAGLER GOLD DEO (W) 150ML#	JAGLER	DEODORANT	â‚º52,00
402000614	JAGLER PEARL DEO (W) 150ML#	JAGLER	DEODORANT	â‚º52,00
401500219	JAGLER CLAS.DEO (M) 150ML R23#	JAGLER	DEODORANT	â‚º52,00
401500220	JAGLER SPORT DEO (M) 150ML R23#	JAGLER	DEODORANT	â‚º52,00
401500221	JAGLER STORM DEO (M) 150ML R23#	JAGLER	DEODORANT	â‚º52,00
401500222	JAGLER BLACK DEO (M) 150ML R23#	JAGLER	DEODORANT	â‚º52,00
402000621	JAGLER CLASSIC DEO (W) 150ML L24#	JAGLER	DEODORANT	â‚º52,00
401600053	JAGLER TRAS KOPUGU 200ML L24#	JAGLER	TRAÅ KÃ–PÃœÄÃœ	â‚º40,00
405500171	JAGLER SPORT TIRAS KOLONYASI 200ML L24#	JAGLER	KOLONYA	â‚º105,50
405500172	JAGLER E.COOL TIRAS KOLONYASI 200ML L24#	JAGLER	KOLONYA	â‚º105,50
405500173	JAGLER CLAS.TIRAS KOLONYASI 200ML L24#	JAGLER	KOLONYA	â‚º105,50
410801588	JAGLER CLASSIC SAC SPRAYI 400ML L24#	JAGLER	SAC SPREYI	â‚º78,00
410801589	JAGLER KERATIN SAC SPRAYI 400ML L24#	JAGLER	SAC SPREYI	â‚º78,00
410801590	JAGLER WAX DOGAL GOR.150ML(M) L24#	JAGLER	WAX	â‚º45,50
410801591	JAGLER WAX PARLAK GOR. 150ML(M) L24#	JAGLER	WAX	â‚º45,50
410801592	JAGLER WAX GUCLU TUTUS 150ML(M) L24#	JAGLER	WAX	â‚º45,50
402700244	JAGLER KLASIK ROLLON (M) 50ML R24#	JAGLER	ROLL-ON	â‚º30,50
402700245	JAGLER SPORT ROLLON (M) 50ML R24#	JAGLER	ROLL-ON	â‚º30,50
402700246	JAGLER STORM ROLLON (M) 50ML R24#	JAGLER	ROLL-ON	â‚º30,50
402700247	JAGLER BLACK ROLLON (M) 50ML R24#	JAGLER	ROLL-ON	â‚º30,50
402700257	JAGLER ROLLON (W) 50ML L24#	JAGLER	ROLL-ON	â‚º30,50
402700235	JAGLER HERO ROLLON (M) 50ML#	JAGLER	ROLL-ON	â‚º30,50
402700236	JAGLER ENERGY ROLLON (M) 50ML#	JAGLER	ROLL-ON	â‚º30,50
402700237	JAGLER EXTREME ROLLON (M) 50ML#	JAGLER	ROLL-ON	â‚º30,50
402700238	JAGLER GOLD ROLLON (W) 50ML#	JAGLER	ROLL-ON	â‚º30,50
402700239	JAGLER PEARL ROLLON (W) 50ML#	JAGLER	ROLL-ON	â‚º30,50
900004233	SHE FUN KUTU KOFRE (W) EDT+DEO L23#	SHE	KOFRE	â‚º184,00
900004234	SHE SEXY KUTU KOFRE (W) EDT+DEO L23#	SHE	KOFRE	â‚º184,00
900004235	SHE COOL KUTU KOFRE (W) EDT+DEO L23#	SHE	KOFRE	â‚º184,00
900004236	SHE LOVE KUTU KOFRE (W) EDT+DEO L23#	SHE	KOFRE	â‚º184,00
900004231	SHE CLUBBER KUTU KOFRE (W) EDT+DEO L23#	SHE	KOFRE	â‚º184,00
900004232	SHE ANGEL KUTU KOFRE (W) EDT+DEO L23#	SHE	KOFRE	â‚º184,00
402000592	SHE CLUBBER DEO (W) 150ML L23#	SHE	DEODORANT	â‚º52,00
402000593	SHE ANGEL DEO (W) 150ML L23#	SHE	DEODORANT	â‚º52,00
402000594	SHE FUN DEO (W) 150ML L23#	SHE	DEODORANT	â‚º52,00
402000595	SHE SEXY DEO (W) 150ML L23#	SHE	DEODORANT	â‚º52,00
402000596	SHE COOL DEO (W) 150ML L23#	SHE	DEODORANT	â‚º52,00
402000597	SHE LOVE DEO (W) 150ML L23#	SHE	DEODORANT	â‚º52,00
402700209	SHE SEXY ROLLON (W) 50ML R23#	SHE	ROLL-ON	â‚º30,50
402700210	SHE FUN ROLLON (W) 50ML R23#	SHE	ROLL-ON	â‚º30,50
402700211	SHE COOL ROLLON (W) 50ML R23#	SHE	ROLL-ON	â‚º30,50
402700212	SHE LOVE ROLLON (W) 50ML R23#	SHE	ROLL-ON	â‚º30,50
402700213	SHE CLUBBER ROLLON (W) 50ML R23#	SHE	ROLL-ON	â‚º30,50
402700216	SHE ANGEL ROLLON (W) 50ML R23#	SHE	ROLL-ON	â‚º30,50
900004181	VIVA CAPPIO KUTU KOFRE (W) EDT+DEO R22#	VIVA	KOFRE	â‚º210,50
400500334	VIVA CAPPIO EDT (W) 60ML R22#	VIVA	EDT	â‚º161,50
402000270	VIVA CAPPIO DEO (W) 150ML#	VIVA	DEODORANT	â‚º52,00
400500340	SHE CLUBBER EDT (W) 50ML L23#	SHE	EDT	â‚º131,00
400500341	SHE ANGEL EDT (W) 50ML L23#	SHE	EDT	â‚º131,00
400500342	SHE FUN EDT (W) 50ML L23#	SHE	EDT	â‚º131,00
400500343	SHE SEXY EDT (W) 50ML L23#	SHE	EDT	â‚º131,00
400500344	SHE COOL EDT (W) 50ML L23#	SHE	EDT	â‚º131,00
400500345	SHE LOVE EDT (W) 50ML L23#	SHE	EDT	â‚º131,00`;

        // Veriyi parse etme
        const productLines = productDataText.split('\n').slice(1); // Ä°lk satÄ±rÄ± (baÅŸlÄ±k) atla
        const productList = {};
        
        productLines.forEach(line => {
            const columns = line.split('\t');
            if (columns.length >= 5) {
                const sap = columns[0].trim();
                const name = columns[1].trim();
                const brand = columns[2].trim();
                const category = columns[3].trim();
                
                // FiyatÄ± parse etme (TL iÅŸaretini ve virgÃ¼lÃ¼ kaldÄ±rma)
                let priceText = columns[4].trim();
                priceText = priceText.replace('â‚º', '').replace(',', '.');
                const price = parseFloat(priceText);
                
                if (!isNaN(price)) {
                    productList[sap] = {
                        name: name,
                        brand: brand,
                        category: category,
                        price: price
                    };
                }
            }
        });
        
        // MarkalarÄ± al
        const brands = [...new Set(Object.values(productList).map(p => p.brand))].sort();
        
        // DOM elementleri
        const brandSelect = document.getElementById('brandSelect');
        const categorySelect = document.getElementById('categorySelect');
        const productSelect = document.getElementById('productSelect');
        const addQuantityInput = document.getElementById('addQuantity');
        const addProductButton = document.getElementById('addProductButton');
        const purchasePriceInput = document.getElementById('purchasePrice');
        const totalQuantityInput = document.getElementById('totalQuantity');
        const totalWithVATInput = document.getElementById('totalWithVAT');
        const salesPriceInput = document.getElementById('salesPrice');
        const commissionRateInput = document.getElementById('commissionRate');
        const cargoTypeSelect = document.getElementById('cargoType');
        const customCargoPriceInput = document.getElementById('customCargoPrice');
        const advertisementRateInput = document.getElementById('advertisementRate');
        const resetButton = document.getElementById('resetButton');
        const clearSetButton = document.getElementById('clearSetButton');
        const createSetButton = document.getElementById('createSetButton');
        const deleteCurrentSetButton = document.getElementById('deleteCurrentSetButton');
        const productSetSection = document.getElementById('productSetSection');
        const productSetList = document.getElementById('productSetList');
        const savedSetsSection = document.getElementById('savedSetsSection');
        const savedSetsList = document.getElementById('savedSetsList');
        const setNameModal = document.getElementById('setNameModal');
        const setNameInput = document.getElementById('setNameInput');
        const confirmSetBtn = document.getElementById('confirmSetBtn');
        const cancelSetBtn = document.getElementById('cancelSetBtn');
        const downloadAllSetsBtn = document.getElementById('downloadAllSetsBtn');
        const deleteAllSetsBtn = document.getElementById('deleteAllSetsBtn');
        
        // Set iÃ§indeki Ã¼rÃ¼nleri saklamak iÃ§in dizi
        let productSet = [];
        let savedSets = [];
        
        // Marka deÄŸiÅŸtiÄŸinde
        brandSelect.addEventListener('change', function() {
            const selectedBrand = this.value;
            categorySelect.disabled = !selectedBrand;
            productSelect.disabled = true;
            addProductButton.disabled = true;
            
            // Kategorileri doldur
            categorySelect.innerHTML = '<option value="">Kategori SeÃ§iniz</option>';
            if (selectedBrand) {
                const categories = [...new Set(
                    Object.values(productList)
                        .filter(p => p.brand === selectedBrand)
                        .map(p => p.category)
                )].sort();
                
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
            }
            
            resetProductSelection();
        });
        
        // Kategori deÄŸiÅŸtiÄŸinde
        categorySelect.addEventListener('change', function() {
            const selectedBrand = brandSelect.value;
            const selectedCategory = this.value;
            productSelect.disabled = !selectedCategory;
            addProductButton.disabled = !selectedCategory;
            
            // ÃœrÃ¼nleri doldur
            productSelect.innerHTML = '<option value="">ÃœrÃ¼n SeÃ§iniz</option>';
            if (selectedBrand && selectedCategory) {
                const filteredProducts = Object.entries(productList)
                    .filter(([sap, product]) => 
                        product.brand === selectedBrand && 
                        product.category === selectedCategory
                    );
                
                filteredProducts.forEach(([sap, product]) => {
                    const option = document.createElement('option');
                    option.value = sap;
                    option.textContent = `${product.name} - â‚º${product.price.toFixed(2)}`;
                    productSelect.appendChild(option);
                });
            }
            
            resetProductSelection();
        });
        
        // ÃœrÃ¼n seÃ§imi deÄŸiÅŸtiÄŸinde
        productSelect.addEventListener('change', function() {
            addProductButton.disabled = !this.value;
        });
        
        // Ekle butonena tÄ±klandÄ±ÄŸÄ±nda
        addProductButton.addEventListener('click', function() {
            const selectedProduct = productSelect.value;
            const quantity = parseInt(addQuantityInput.value) || 1;
            
            if (selectedProduct && productList[selectedProduct]) {
                const product = productList[selectedProduct];
                
                // ÃœrÃ¼nÃ¼ sete ekle
                productSet.push({
                    sap: selectedProduct,
                    name: product.name,
                    brand: product.brand,
                    category: product.category,
                    price: product.price,
                    quantity: quantity
                });
                
                // Seti gÃ¼ncelle
                updateProductSet();
                updateCalculations();
                
                // SeÃ§imleri sÄ±fÄ±rla
                productSelect.value = "";
                addQuantityInput.value = "1";
                addProductButton.disabled = true;
            }
        });
        
        // Set oluÅŸtur butonuna tÄ±klandÄ±ÄŸÄ±nda
        createSetButton.addEventListener('click', function() {
            if (productSet.length === 0) {
                alert("Set oluÅŸturmak iÃ§in en az bir Ã¼rÃ¼n eklemelisiniz.");
                return;
            }
            
            // ModalÄ± gÃ¶ster
            setNameModal.classList.remove('hidden');
            setNameInput.value = `Set ${savedSets.length + 1}`;
            setNameInput.focus();
        });
        
        // Seti sil butonuna tÄ±klandÄ±ÄŸÄ±nda
        deleteCurrentSetButton.addEventListener('click', function() {
            if (productSet.length === 0) {
                alert("Silinecek set bulunamadÄ±.");
                return;
            }
            
            if (confirm("Mevcut seti silmek istediÄŸinize emin misiniz?")) {
                productSet = [];
                updateProductSet();
                updateCalculations();
            }
        });
        
        // Set ismi modal iÅŸlemleri
        confirmSetBtn.addEventListener('click', function() {
            const setName = setNameInput.value.trim();
            if (!setName) {
                alert("LÃ¼tfen bir set ismi girin.");
                return;
            }
            
            // Seti kaydet
            saveSet(setName);
            
            // ModalÄ± gizle
            setNameModal.classList.add('hidden');
        });
        
        cancelSetBtn.addEventListener('click', function() {
            setNameModal.classList.add('hidden');
        });
        
        // TÃ¼m setleri indir butonuna tÄ±klandÄ±ÄŸÄ±nda
        downloadAllSetsBtn.addEventListener('click', function() {
            if (savedSets.length === 0) {
                alert("Ä°ndirilecek set bulunamadÄ±.");
                return;
            }
            
            downloadAllSets();
        });
        
        // TÃ¼m setleri sil butonuna tÄ±klandÄ±ÄŸÄ±nda
        deleteAllSetsBtn.addEventListener('click', function() {
            if (savedSets.length === 0) {
                alert("Silinecek set bulunamadÄ±.");
                return;
            }
            
            if (confirm("TÃ¼m setleri silmek istediÄŸinize emin misiniz? Bu iÅŸlem geri alÄ±namaz.")) {
                savedSets = [];
                updateSavedSets();
                savedSetsSection.classList.add('hidden');
            }
        });
        
        // Miktar deÄŸiÅŸtiÄŸinde
        addQuantityInput.addEventListener('input', function() {
            updateQuantityDisplays();
        });
        
        // SatÄ±ÅŸ fiyatÄ± deÄŸiÅŸtiÄŸinde
        salesPriceInput.addEventListener('input', function() {
            updateCalculations();
        });
        
        // Komisyon oranÄ± deÄŸiÅŸtiÄŸinde
        commissionRateInput.addEventListener('input', function() {
            updateCalculations();
        });
        
        // Kargo tÃ¼rÃ¼ deÄŸiÅŸtiÄŸinde
        cargoTypeSelect.addEventListener('change', function() {
            document.getElementById('cargoTypeLabel').textContent = this.value;
            const isCustomCargo = this.value === 'Ã–zel Kargo';
            document.getElementById('standardCargo').classList.toggle('hidden', isCustomCargo);
            document.getElementById('customCargo').classList.toggle('hidden', !isCustomCargo);
            updateCalculations();
        });
        
        // Ã–zel kargo fiyatÄ± deÄŸiÅŸtiÄŸinde
        customCargoPriceInput.addEventListener('input', function() {
            updateCalculations();
        });
        
        // Reklam oranÄ± deÄŸiÅŸtiÄŸinde
        advertisementRateInput.addEventListener('input', function() {
            updateCalculations();
        });
        
        // SÄ±fÄ±rlama butonu
        resetButton.addEventListener('click', function() {
            resetAll();
        });
        
        // Seti temizle butonu
        clearSetButton.addEventListener('click', function() {
            productSet = [];
            updateProductSet();
            updateCalculations();
        });
        
        // YardÄ±mcÄ± fonksiyonlar
        function resetProductSelection() {
            productSelect.value = "";
            addProductButton.disabled = true;
        }
        
        function updateProductSet() {
            // Seti temizle
            productSetList.innerHTML = '';
            
            // Set boÅŸsa bÃ¶lÃ¼mÃ¼ gizle
            if (productSet.length === 0) {
                productSetSection.classList.add('hidden');
                return;
            }
            
            // Set bÃ¶lÃ¼mÃ¼nÃ¼ gÃ¶ster
            productSetSection.classList.remove('hidden');
            
            // Seti doldur
            let totalWithoutVAT = 0;
            let totalQuantity = 0;
            
            productSet.forEach((product, index) => {
                const row = document.createElement('tr');
                row.className = 'product-item';
                
                const productTotal = product.price * product.quantity;
                totalWithoutVAT += productTotal;
                totalQuantity += product.quantity;
                
                row.innerHTML = `
                    <td class="p-4">${product.name}</td>
                    <td class="p-4 text-center">${product.brand}</td>
                    <td class="p-4 text-center">${product.category}</td>
                    <td class="p-4 text-center">â‚º${product.price.toFixed(2)}</td>
                    <td class="p-4 text-center">${product.quantity}</td>
                    <td class="p-4 text-center">â‚º${productTotal.toFixed(2)}</td>
                    <td class="p-4 text-center">
                        <button class="text-red-500 hover:text-red-700 remove-product" data-index="${index}">
                            âŒ
                        </button>
                    </td>
                `;
                
                productSetList.appendChild(row);
            });
            
            // ToplamlarÄ± gÃ¼ncelle
            document.getElementById('setTotalWithoutVAT').textContent = `â‚º${totalWithoutVAT.toFixed(2)}`;
            document.getElementById('setTotalWithVAT').textContent = `â‚º${(totalWithoutVAT * 1.20).toFixed(2)}`;
            
            // KaldÄ±r butonlarÄ±na event listener ekle
            document.querySelectorAll('.remove-product').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    productSet.splice(index, 1);
                    updateProductSet();
                    updateCalculations();
                });
            });
            
            // Toplam alÄ±ÅŸ fiyatÄ±nÄ± gÃ¼ncelle
            purchasePriceInput.value = totalWithoutVAT.toFixed(2);
            totalQuantityInput.value = totalQuantity;
            totalWithVATInput.value = (totalWithoutVAT * 1.20).toFixed(2);
        }
        
        function saveSet(setName) {
            const salesPrice = parseFloat(salesPriceInput.value) || 0;
            const netProfit = parseFloat(document.getElementById('netProfit').textContent.replace('â‚º', '')) || 0;
            const sharedProfit = parseFloat(document.getElementById('sharedProfit').textContent.replace('â‚º', '')) || 0;
            
            // Set bilgilerini oluÅŸtur
            const setInfo = {
                id: Date.now(), // Benzersiz ID
                name: setName,
                products: [...productSet], // ÃœrÃ¼nlerin kopyasÄ±
                productCount: productSet.length,
                productNames: productSet.map(p => p.name).join(', '),
                salesPrice: salesPrice,
                netProfit: netProfit,
                sharedProfit: sharedProfit,
                timestamp: new Date().toLocaleString('tr-TR')
            };
            
            // Seti kaydet
            savedSets.push(setInfo);
            
            // Kaydedilen setleri gÃ¼ncelle
            updateSavedSets();
            
            // Kaydedilen setler bÃ¶lÃ¼mÃ¼nÃ¼ gÃ¶ster
            savedSetsSection.classList.remove('hidden');
            
            // Seti temizle
            productSet = [];
            updateProductSet();
            updateCalculations();
        }
        
        function updateSavedSets() {
            // Kaydedilen setleri temizle
            savedSetsList.innerHTML = '';
            
            // Kaydedilen setleri doldur
            savedSets.forEach((set, index) => {
                const row = document.createElement('tr');
                row.className = 'product-item';
                
                row.innerHTML = `
                    <td class="p-4 font-semibold">${set.name}</td>
                    <td class="p-4 text-center">${set.productCount}</td>
                    <td class="p-4 text-center" title="${set.productNames}">${set.productNames.length > 50 ? set.productNames.substring(0, 50) + '...' : set.productNames}</td>
                    <td class="p-4 text-center">â‚º${set.salesPrice.toFixed(2)}</td>
                    <td class="p-4 text-center">â‚º${set.netProfit.toFixed(2)}</td>
                    <td class="p-4 text-center">â‚º${set.sharedProfit.toFixed(2)}</td>
                    <td class="p-4 text-center">
                        <button class="text-red-500 hover:text-red-700 delete-set" data-id="${set.id}" title="Seti Sil">
                            ğŸ—‘ï¸
                        </button>
                    </td>
                `;
                
                savedSetsList.appendChild(row);
            });
            
            // Sil butonlarÄ±na event listener ekle
            document.querySelectorAll('.delete-set').forEach(button => {
                button.addEventListener('click', function() {
                    const setId = parseInt(this.getAttribute('data-id'));
                    deleteSet(setId);
                });
            });
        }
        
        function downloadAllSets() {
            // Excel verisini oluÅŸtur
            const workbook = XLSX.utils.book_new();
            
            // Set Ã¶zeti sayfasÄ±
            const summaryData = [
                ['Set AdÄ±', 'ÃœrÃ¼n Adedi', 'SatÄ±ÅŸ FiyatÄ±', 'Net Kar', 'PaylaÅŸÄ±lacak Kar', 'OluÅŸturulma Tarihi']
            ];
            
            savedSets.forEach(set => {
                summaryData.push([
                    set.name,
                    set.productCount,
                    set.salesPrice,
                    set.netProfit,
                    set.sharedProfit,
                    set.timestamp
                ]);
            });
            
            const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(workbook, summarySheet, "Set Ã–zeti");
            
            // Her set iÃ§in ayrÄ±ntÄ±lÄ± sayfalar oluÅŸtur
            savedSets.forEach(set => {
                const detailData = [
                    ['Set AdÄ±', set.name],
                    ['OluÅŸturulma Tarihi', set.timestamp],
                    ['SatÄ±ÅŸ FiyatÄ±', `â‚º${set.salesPrice.toFixed(2)}`],
                    ['Net Kar', `â‚º${set.netProfit.toFixed(2)}`],
                    ['PaylaÅŸÄ±lacak Kar', `â‚º${set.sharedProfit.toFixed(2)}`],
                    [],
                    ['ÃœrÃ¼n Listesi'],
                    ['ÃœrÃ¼n AdÄ±', 'Marka', 'Kategori', 'Birim Fiyat', 'Adet', 'Toplam']
                ];
                
                set.products.forEach(product => {
                    detailData.push([
                        product.name,
                        product.brand,
                        product.category,
                        product.price,
                        product.quantity,
                        product.price * product.quantity
                    ]);
                });
                
                // Toplam satÄ±rÄ±
                detailData.push([
                    'TOPLAM', '', '', '', '',
                    set.products.reduce((sum, product) => sum + (product.price * product.quantity), 0)
                ]);
                
                const detailSheet = XLSX.utils.aoa_to_sheet(detailData);
                XLSX.utils.book_append_sheet(workbook, detailSheet, set.name.substring(0, 30)); // Excel sayfa adÄ± 31 karakterle sÄ±nÄ±rlÄ±
            });
            
            // Excel dosyasÄ±nÄ± indir
            XLSX.writeFile(workbook, "Hunca_Setler.xlsx");
        }
        
        function deleteSet(setId) {
            if (confirm("Bu seti silmek istediÄŸinize emin misiniz?")) {
                savedSets = savedSets.filter(s => s.id !== setId);
                updateSavedSets();
                
                // EÄŸer hiÃ§ set kalmadÄ±ysa bÃ¶lÃ¼mÃ¼ gizle
                if (savedSets.length === 0) {
                    savedSetsSection.classList.add('hidden');
                }
            }
        }
        
        function updateQuantityDisplays() {
            const quantity = parseInt(addQuantityInput.value) || 1;
            const quantityDisplays = document.querySelectorAll('[id^="quantityDisplay"]');
            quantityDisplays.forEach(el => {
                el.textContent = quantity;
            });
        }
        
        function updateCalculations() {
            const purchasePrice = parseFloat(purchasePriceInput.value) || 0;
            const totalQuantity = parseInt(totalQuantityInput.value) || 0;
            const salesPrice = parseFloat(salesPriceInput.value) || 0;
            const commissionRate = parseFloat(commissionRateInput.value) || 0;
            const advertisementRate = parseFloat(advertisementRateInput.value) || 0;
            
            // Hunca ve KÄ±rmÄ±zÄ± Beyaz kar hesaplamalarÄ±
            const huncaProfit = purchasePrice * 0.1803;
            const redWhiteProfit = purchasePrice * 0.0984;
            const huncaProfitWithVAT = huncaProfit * 1.20;
            const redWhiteProfitWithVAT = redWhiteProfit * 1.20;
            const totalHuncaProfit = huncaProfit;
            const totalRedWhiteProfit = redWhiteProfit;
            const totalHuncaProfitWithVAT = huncaProfitWithVAT;
            const totalRedWhiteProfitWithVAT = redWhiteProfitWithVAT;
            
            // Komisyon ve reklam hesaplamalarÄ±
            const commissionAmount = (salesPrice * commissionRate) / 100;
            const advertisementAmount = (salesPrice * advertisementRate) / 100;
            
            // Kargo hesaplamasÄ±
            let cargoPrice = 0;
            if (cargoTypeSelect.value === 'PTT-TEX' && salesPrice > 0) {
                if (salesPrice >= 0 && salesPrice <= 149.99) {
                    cargoPrice = 50; // KDV dahil
                } else if (salesPrice >= 150 && salesPrice <= 299.99) {
                    cargoPrice 90; // KDV dahil
                } else if (salesPrice >= 300) {
                    cargoPrice = 110; // KDV dahil
                }
            } else if (cargoTypeSelect.value === 'Ã–zel Kargo') {
                cargoPrice = parseFloat(customCargoPriceInput.value) || 0;
            }
            
            // Net kar hesaplamalarÄ±
            const netProfit = salesPrice - commissionAmount - cargoPrice - advertisementAmount - (purchasePrice * 1.20);
            
            // NET KAR ORANI: Toplam AlÄ±ÅŸ Maliyeti (KDV Dahil) oranÄ±na gÃ¶re hesapla
            const totalPurchaseWithVAT = purchasePrice * 1.20;
            const netProfitRate = totalPurchaseWithVAT ? (netProfit / totalPurchaseWithVAT) * 100 : 0;
            
            const finalProfit = netProfit - totalRedWhiteProfitWithVAT;
            
            // Yeni hesaplamalar: PaylaÅŸÄ±lacak Kar ve Hunca Kar Hak EdiÅŸ
            const sharedProfit = finalProfit; // PaylaÅŸÄ±lacak Kar (TL)
            const sharedProfitRate = totalPurchaseWithVAT ? (sharedProfit / totalPurchaseWithVAT) * 100 : 0; // PaylaÅŸÄ±lacak Kar (%)
            const huncaProfitShare = sharedProfit / 2; // Hunca Kar Hak EdiÅŸ (PaylaÅŸÄ±lacak KarÄ±n yarÄ±sÄ±)
            
            // DeÄŸerleri gÃ¼ncelle
            document.getElementById('huncaProfit').textContent = `â‚º${huncaProfit.toFixed(2)}`;
            document.getElementById('redWhiteProfit').textContent = `â‚º${redWhiteProfit.toFixed(2)}`;
            document.getElementById('huncaProfitWithVAT').textContent = `â‚º${huncaProfitWithVAT.toFixed(2)}`;
            document.getElementById('redWhiteProfitWithVAT').textContent = `â‚º${redWhiteProfitWithVAT.toFixed(2)}`;
            document.getElementById('totalHuncaProfit').textContent = `â‚º${totalHuncaProfit.toFixed(2)}`;
            document.getElementById('totalRedWhiteProfit').textContent = `â‚º${totalRedWhiteProfit.toFixed(2)}`;
            document.getElementById('totalHuncaProfitWithVAT').textContent = `â‚º${totalHuncaProfitWithVAT.toFixed(2)}`;
            document.getElementById('totalRedWhiteProfitWithVAT').textContent = `â‚º${totalRedWhiteProfitWithVAT.toFixed(2)}`;
            
            document.getElementById('commissionAmount').textContent = `â‚º${commissionAmount.toFixed(2)}`;
            document.getElementById('cargoPrice').textContent = `â‚º${cargoPrice.toFixed(2)}`;
            document.getElementById('advertisementAmount').textContent = `â‚º${advertisementAmount.toFixed(2)}`;
            
            document.getElementById('netProfitRate').textContent = `${netProfitRate.toFixed(2)}%`;
            document.getElementById('netProfit').textContent = `â‚º${netProfit.toFixed(2)}`;
            document.getElementById('finalProfit').textContent = `â‚º${finalProfit.toFixed(2)}`;
            
            // Yeni deÄŸerleri gÃ¼ncelle
            document.getElementById('sharedProfitRate').textContent = `${sharedProfitRate.toFixed(2)}%`;
            document.getElementById('sharedProfit').textContent = `â‚º${sharedProfit.toFixed(2)}`;
            document.getElementById('huncaProfitShare').textContent = `â‚º${huncaProfitShare.toFixed(2)}`;
            
            // Miktar gÃ¶sterimlerini gÃ¼ncelle
            const quantityDisplays = document.querySelectorAll('[id^="quantityDisplay"]');
            quantityDisplays.forEach(el => {
                el.textContent = totalQuantity;
            });
        }
        
        function resetAll() {
            brandSelect.value = "";
            categorySelect.innerHTML = '<option value="">Kategori SeÃ§iniz</option>';
            categorySelect.disabled = true;
            productSelect.innerHTML = '<option value="">ÃœrÃ¼n SeÃ§iniz</option>';
            productSelect.disabled = true;
            addQuantityInput.value = "1";
            addProductButton.disabled = true;
            
            purchasePriceInput.value = "0";
            totalQuantityInput.value = "0";
            totalWithVATInput.value = "0";
            salesPriceInput.value = "";
            commissionRateInput.value = "";
            advertisementRateInput.value = "";
            cargoTypeSelect.value = "PTT-TEX";
            document.getElementById('cargoTypeLabel').textContent = "PTT-TEX";
            document.getElementById('standardCargo').classList.remove('hidden');
            document.getElementById('customCargo').classList.add('hidden');
            customCargoPriceInput.value = "";
            
            productSet = [];
            updateProductSet();
            
            updateCalculations();
            updateQuantityDisplays();
        }
        
        // Sayfa yÃ¼klendiÄŸinde marka seÃ§eneklerini doldur
        window.addEventListener('DOMContentLoaded', function() {
            brands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand;
                option.textContent = brand;
                brandSelect.appendChild(option);
            });
            
            updateQuantityDisplays();
            updateCalculations();
        });
        
        // Geri dÃ¶n butonu fonksiyonu
        function goBack() {
            window.location.href = "https://gurkankuscu.github.io/e-ticaret-urunleri-fiyatlandirma-ve-bilgi-sistemi-1.0-2025/";
        }
    </script>
</body>
</html>
